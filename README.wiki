---
title: README

---
= neicweb =

NeIC Static Website

Adapted by Joel Hedlund (NeIC, NSC) based a framework built by Peter Larsson (NSC).

== How to create pages ==

=== Creating the file ===
First decide if you want to make a news post or a normal page.

For normal pages: make a directory and put an index.wiki* file in it, like so: 

 /about/areas/bms/af/index.wiki. 

: &#42; ''Expert option:'' Making .html files instead allows you to opt out of pandoc and write raw Jekyll/HTML5 instead. Please refrain from this. Be considerate to the people who will be stuck maintining whatever ghastly magic you produce. This is about keeping it simple. 

For news posts: put a YYYY-MM-DD-some-name.wiki* file in the /_posts/ directory, like so:

 /_posts/2014-08-14-nt1-seeking-sysadm.wiki

: &#42; ''Note:'' The news post naming scheme is not required, but a convenience.

=== Edit the page ===
Pages should be written using mediawiki markup, and must start with a YAML front matter data block, like so:

 ---
 title: BMS advisory forum
 ---

: &#42; ''Note:'' If you do not add a data block then Jekyll will not process the file. Jekyll will instead include it as-is, which is probably not what you want.


==== Variables ====
Some variable names are used by all page layouts, and some layouts take additional variables. The currently used variables are:
* Used by all page layouts:
** '''title''' ''Required'' Short title, used for link text.
** '''layout''' ''Optional'' Select page layout: menu or news. menu is default. News post pages should have the news layout. All others should have the menu layout.
* menu layout (=all normal pages):
** '''description''' ''Optional'' Very short descrition of page, used for link tooltips.
** '''menu''' ''Optional'' A number giving a rough indication whether this page should show up in the beginning or towards the end of a menu list. Lower numbers go first. Default is 100.
* news layout (only news posts):
** '''date''' ''Required'' An ISO date, like 2014-09-10. 
** '''summary''' ''Optional'' A short blurb describing the news post. Used on lists of news posts.
** '''image''' ''Optional'' Url to a small(ish) image. Used on lists of news posts. If given, recommendation is to put the image in /assets/img/posts/SAME-NAME.jpg. Do not put large files here (see "Large files" below).

==== Add media to your page ====
Upload your media files to the server, and display them using e.g:

 <nowiki>[[File:small.png|]]</nowiki>
 <nowiki>[[File:/media/about/huge.png|]]</nowiki>

==== Large media files ====
'''Do not put large files in the repository''' as doing so will bloat the repo forever. Version control will ensure it stays in there even if you "delete" it later. 

Use ssh to upload large files into the /media directory, e.g:
 
 /media/SAME/PATH/AS/YOUR/PAGE/bloat.ppt 
 /media/posts/SAME-NAME-AS-POST-img-name.jpeg

==== Small media files ====

Put small one-off files in the same directory as your page file. If it's something that will see reuse, like a small logo file, consider putting it in

 /assets/img/SENSIBLE/PATH/logo.png

== How to run your own copy of this website using Jekyll ==

Clone the neicweb repository, and cd into it:

 git clone git@github.com:yohell/neicweb.git
 cd neicweb

We use the new "rbenv":

 git clone https://github.com/sstephenson/rbenv.git ~/.rbenv
	
Add to the .bash_profile:

 export PATH="$HOME/.rbenv/bin:$PATH"
 eval "$(rbenv init -)"

Install the ruby-build plugin:

 git clone https://github.com/sstephenson/ruby-build.git ~/.rbenv/plugins/ruby-build

Run eval "$(rbenv init -)" again.

Check that it works by running:

 rbenv install --list

Install the same version of Ruby as on the webserver (2.0.0p598 at the time, but please check)

 rbenv install 2.0.0p598

Building ruby may require you to install additional build packages, for example:

 yum groupinstall "Development Tools"
 yum install autoconf byacc

Change Ruby version

 rbenv global 2.0.0p598
	   
Install same version Jekyll as on the webserver
		
 gem update
 gem install jekyll -v 2.5.3
 
We need Pandoc and pandoc-ruby to build the site.

 yum install pandoc
 gem install pandoc-ruby --no-rdoc --no-ri

And RedCloth

 gem install RedCloth --no-rdoc --no-ri

The commands to build the site are:

 jekyll build
 jekyll serve --watch 

The latter command will launch the web server locally on port 4000, and rebuild the site if any of the files are modified.
